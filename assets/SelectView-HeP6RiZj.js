import{d as v,c as p,a as f,f as L,t as w,u as N,o as g,g as O,_ as M,h as R,i as S,j as T,k as F,b as j,F as V,r as P,l as q}from"./index-C66TtbAj.js";const X={class:"flex justify-between items-center mb-4"},Y={key:0,class:"artifact-detail"},G=["src"],J={class:"text-xl font-semibold"},K={key:1,class:"text-gray-500"},Q=v({__name:"ArtifactDetail",props:{artifact:{type:Object,default:null}},setup(t){const r=t,e=N(),o=()=>{var a;e.push(`/detail/${(a=r.artifact)==null?void 0:a.id}`)};return(a,s)=>(g(),p("div",null,[f("div",X,[s[0]||(s[0]=f("h2",{class:"text-2xl font-bold"},"文物展示",-1)),t.artifact?(g(),p("button",{key:0,onClick:o,class:"bg-gradient-to-r from-blue-500 to-indigo-500 text-white px-4 py-2 rounded shadow-lg hover:from-blue-600 hover:to-indigo-600 focus:outline-none focus:ring-2 focus:ring-blue-300 dark:focus:ring-indigo-700 transition duration-300 ease-in-out"}," 查看 3D 模型 ")):L("",!0)]),t.artifact?(g(),p("div",Y,[f("img",{src:t.artifact.imageUrl,alt:"Artifact Image",class:"w-full h-auto mb-4"},null,8,G),f("h3",J,w(t.artifact.name),1),f("p",null,w(t.artifact.description),1)])):(g(),p("div",K,"拖拽文物到此处查看详情"))]))}}),Z={class:"group overflow-hidden",draggable:"true"},tt=["src"],et={class:"absolute bottom-0 left-0 w-full bg-white/40 dark:bg-black/40 backdrop-blur-md p-4 text-sm text-gray-800 dark:text-gray-200 transform translate-y-full group-hover:translate-y-0 transition-transform duration-200 ease-in-out select-none"},rt=v({__name:"ArtifactItem",props:{artifact:{type:Object,required:!0}},emits:["dragstart","click"],setup(t,{emit:r}){const e=t,o=r,a=()=>{o("dragstart",e.artifact)},s=()=>{o("click",e.artifact)};return(i,c)=>(g(),p("div",Z,[t.artifact.imageUrl.length>0?(g(),p("img",{key:0,src:t.artifact.imageUrl,alt:"Artifact Image",class:"w-full h-auto object-cover group-hover:scale-125 duration-200",loading:"lazy",onDragstart:a,onClick:s},null,40,tt)):L("",!0),f("div",et,w(t.artifact.description),1)]))}}),ot={class:"upload-item flex items-center justify-center border-2 border-dashed border-gray-300 p-4 cursor-pointer"},st=v({__name:"UploadButton",emits:["upload"],setup(t,{emit:r}){const e=r,o=O(null),a=()=>{o.value&&o.value.click()},s=i=>{var l;const u=(l=i.target.files)==null?void 0:l[0];if(u){const n=new FileReader;n.onload=d=>{d.target&&e("upload",d.target.result)},n.readAsDataURL(u)}};return(i,c)=>(g(),p("div",ot,[f("input",{type:"file",onChange:s,class:"hidden",ref_key:"fileInput",ref:o},null,544),f("button",{onClick:a,class:"text-gray-500 dark:text-gray-300"}," 上传文物图片 ")]))}}),at=M(st,[["__scopeId","data-v-9ad6f98c"]]);var nt="wc-waterfall{position:relative;display:block;box-sizing:border-box!important;overflow:unset!important}wc-waterfall>*{position:absolute;box-sizing:border-box}";const D=t=>t.nodeType==1,it=(t,r)=>{const e=t();class o extends HTMLElement{constructor(){super(),this.$props=t();const s={};for(const i in this.$props)s[i]={get:()=>this.$props[i],set:c=>{this.$props[i]=r!=null&&r[i]?r[i](c):H(e,i,c),this.render()}};Object.defineProperties(this,s)}static get observedAttributes(){return Object.keys(e).filter(s=>U(e[s]))}attributeChangedCallback(s,i,c){this.$props[s]=r!=null&&r[s]?r[s](c):H(e,s,c)}}return o},H=(t,r,e)=>{const o=t[r];return U(o)?{number:a=>Number(a),string:a=>String(a),boolean:a=>a!=null&&a!="false"}[typeof o](e):void 0},U=t=>{const r=typeof t;return r=="number"||r=="string"||r=="boolean"};function ct(t){let r=0;for(let e=0;e<t.length;e++)r=t[r]<=t[e]?r:e;return r}function lt(t,{getW:r,setW:e,getH:o,setH:a,getPad:s,setX:i,setY:c,getChildren:u},{cols:l,gap:n}){const[d,m]=Array.isArray(n)?n:[n,n],[A,z,C,$]=s(t),b=u(t),E=b.length;if(E){const W=(r(t)-d*(l-1)-($+z))/l;Array.prototype.forEach.call(b,h=>e(h,W));const B=Array.prototype.map.call(b,h=>o(h)),y=Array(l).fill(A);for(let h=0;h<E;h++){const I=b[h],_=ct(y);c(I,y[_]),i(I,$+(W+d)*_),y[_]+=B[h]+m}a(t,Math.max(...y)-m+C)}else a(t,A+C)}const x=Symbol(),k=Symbol();function dt(t,r){let e,o,a;function s(){e=new ResizeObserver(l=>l.some(({target:n})=>n[k]!=n.offsetWidth||n[x]!=n.offsetHeight)&&u()),e.observe(t),Array.prototype.forEach.call(t.children,l=>e.observe(l)),o=new MutationObserver(l=>{l.forEach(n=>{n.addedNodes.forEach(d=>D(d)&&e.observe(d)),n.removedNodes.forEach(d=>D(d)&&e.unobserve(d))}),u()}),o.observe(t,{childList:!0,attributes:!1}),a=new MutationObserver(()=>u()),a.observe(t,{childList:!1,attributes:!0}),u()}function i(){e.disconnect(),o.disconnect(),a.disconnect()}let c=!1;function u(){c||(c=!0,requestAnimationFrame(()=>{r(),t[k]=t.offsetWidth,t[x]=t.offsetHeight,a.takeRecords(),c=!1}))}return{relayout:u,mount:s,unmount:i}}const ut=(t,r)=>dt(t,()=>{lt(t,{getW:e=>e.offsetWidth,setW:(e,o)=>e.style.width=o+"px",getH:e=>(e[k]=e.offsetWidth,e[x]=e.offsetHeight),setH:(e,o)=>e.style.height=o+"px",getPad:e=>{const o=getComputedStyle(e);return[parseInt(o.paddingTop),parseInt(o.paddingRight),parseInt(o.paddingBottom),parseInt(o.paddingLeft)]},setX:(e,o)=>e.style.left=o+"px",setY:(e,o)=>e.style.top=o+"px",getChildren:e=>e.children},r)});document.head.appendChild(Object.assign(document.createElement("style"),{innerText:nt}));const ft=()=>({cols:2,gap:4}),gt={gap:t=>typeof t=="string"?t.includes(" ")?t.split(" ").map(Number):Number(t):t};class pt extends it(ft,gt){constructor(){super()}connectedCallback(){this._layout=ut(this,this),this._layout.mount()}disconnectedCallback(){this._layout.unmount()}render(){var r;(r=this._layout)==null||r.relayout()}}customElements.get("wc-waterfall")||customElements.define("wc-waterfall",pt);const ht={class:"flex min-h-screen dark:text-gray-200"},mt={class:"w-1/3 hidden lg:block bg-gray-100 dark:bg-gray-800 p-4 h-screen overflow-y-auto"},bt={class:"flex-1 p-4 h-screen overflow-y-auto dark:bg-gray-900"},yt=["cols"],_t=v({__name:"SelectView",setup(t){const r=R(),e=S(()=>r.artifacts),o=S(()=>r.currentArtifact),a=N(),s=O(3),i=()=>{window.innerWidth>=1280?s.value=4:window.innerWidth>=768?s.value=3:window.innerWidth>=400?s.value=2:s.value=1};T(()=>{i(),window.addEventListener("resize",i)}),F(()=>{window.removeEventListener("resize",i)});const c=n=>{r.setCurrentArtifact(n)},u=n=>{r.setCurrentArtifact(n),window.innerWidth<1024&&a.push(`/detail/${n.id}`)},l=n=>{const d={id:Date.now().toString(),name:"新文物",imageUrl:n,description:"新上传的文物描述"};r.artifacts.push(d)};return(n,d)=>(g(),p("div",ht,[f("div",mt,[j(Q,{artifact:o.value},null,8,["artifact"])]),f("div",bt,[f("wc-waterfall",{gap:4,cols:s.value},[(g(!0),p(V,null,P(e.value,m=>(g(),q(rt,{key:m.id,artifact:m,onDragstart:c,onClick:u},null,8,["artifact"]))),128)),j(at,{onUpload:l})],8,yt)])]))}});export{_t as default};
