import{d as _,c as h,a as f,f as M,t as W,u as L,o as p,_ as N,g as O,h as R,i as S,j as T,k as F,b as j,F as V,r as P,l as q}from"./index-CHuhwvNT.js";const X={class:"flex justify-between items-center mb-4"},Y={key:0,class:"artifact-detail"},G=["src"],J={class:"text-xl font-semibold"},K={key:1,class:"text-gray-500"},Q=_({__name:"ArtifactDetail",props:{artifact:{type:Object,default:null}},setup(t){const r=t,e=L(),s=()=>{var a;e.push(`/detail/${(a=r.artifact)==null?void 0:a.id}`)};return(a,o)=>(p(),h("div",null,[f("div",X,[o[0]||(o[0]=f("h2",{class:"text-2xl font-bold"},"文物展示",-1)),t.artifact?(p(),h("button",{key:0,onClick:s,class:"bg-gradient-to-r from-blue-500 to-indigo-500 text-white px-4 py-2 rounded shadow-lg hover:from-blue-600 hover:to-indigo-600 focus:outline-none focus:ring-2 focus:ring-blue-300 dark:focus:ring-indigo-700 transition duration-300 ease-in-out"}," 查看 3D 模型 ")):M("",!0)]),t.artifact?(p(),h("div",Y,[f("img",{src:t.artifact.imageUrl,alt:"Artifact Image",class:"w-full h-auto mb-4"},null,8,G),f("h3",J,W(t.artifact.name),1),f("p",null,W(t.artifact.description),1)])):(p(),h("div",K,"拖拽文物到此处查看详情"))]))}}),Z=["src"],tt=_({__name:"ArtifactItem",props:{artifact:{type:Object,required:!0}},emits:["dragstart","click"],setup(t,{emit:r}){const e=t,s=r,a=()=>{s("dragstart",e.artifact)},o=()=>{s("click",e.artifact)};return(i,c)=>(p(),h("img",{src:t.artifact.imageUrl,alt:"Artifact Image",class:"w-full h-auto object-cover artifact-item",draggable:"true",loading:"lazy",onDragstart:a,onClick:o},null,40,Z))}}),et=N(tt,[["__scopeId","data-v-37b1daa2"]]),rt={class:"upload-item flex items-center justify-center border-2 border-dashed border-gray-300 p-4 cursor-pointer"},st=_({__name:"UploadButton",emits:["upload"],setup(t,{emit:r}){const e=r,s=O(null),a=()=>{s.value&&s.value.click()},o=i=>{var l;const u=(l=i.target.files)==null?void 0:l[0];if(u){const n=new FileReader;n.onload=d=>{d.target&&e("upload",d.target.result)},n.readAsDataURL(u)}};return(i,c)=>(p(),h("div",rt,[f("input",{type:"file",onChange:o,class:"hidden",ref_key:"fileInput",ref:s},null,544),f("button",{onClick:a,class:"text-gray-500 dark:text-gray-300"}," 上传文物图片 ")]))}}),ot=N(st,[["__scopeId","data-v-d9db4efd"]]);var at="wc-waterfall{position:relative;display:block;box-sizing:border-box!important;overflow:unset!important}wc-waterfall>*{position:absolute;box-sizing:border-box}";const D=t=>t.nodeType==1,nt=(t,r)=>{const e=t();class s extends HTMLElement{constructor(){super(),this.$props=t();const o={};for(const i in this.$props)o[i]={get:()=>this.$props[i],set:c=>{this.$props[i]=r!=null&&r[i]?r[i](c):H(e,i,c),this.render()}};Object.defineProperties(this,o)}static get observedAttributes(){return Object.keys(e).filter(o=>U(e[o]))}attributeChangedCallback(o,i,c){this.$props[o]=r!=null&&r[o]?r[o](c):H(e,o,c)}}return s},H=(t,r,e)=>{const s=t[r];return U(s)?{number:a=>Number(a),string:a=>String(a),boolean:a=>a!=null&&a!="false"}[typeof s](e):void 0},U=t=>{const r=typeof t;return r=="number"||r=="string"||r=="boolean"};function it(t){let r=0;for(let e=0;e<t.length;e++)r=t[r]<=t[e]?r:e;return r}function ct(t,{getW:r,setW:e,getH:s,setH:a,getPad:o,setX:i,setY:c,getChildren:u},{cols:l,gap:n}){const[d,m]=Array.isArray(n)?n:[n,n],[k,z,A,C]=o(t),b=u(t),$=b.length;if($){const I=(r(t)-d*(l-1)-(C+z))/l;Array.prototype.forEach.call(b,g=>e(g,I));const B=Array.prototype.map.call(b,g=>s(g)),y=Array(l).fill(k);for(let g=0;g<$;g++){const E=b[g],v=it(y);c(E,y[v]),i(E,C+(I+d)*v),y[v]+=B[g]+m}a(t,Math.max(...y)-m+A)}else a(t,k+A)}const w=Symbol(),x=Symbol();function lt(t,r){let e,s,a;function o(){e=new ResizeObserver(l=>l.some(({target:n})=>n[x]!=n.offsetWidth||n[w]!=n.offsetHeight)&&u()),e.observe(t),Array.prototype.forEach.call(t.children,l=>e.observe(l)),s=new MutationObserver(l=>{l.forEach(n=>{n.addedNodes.forEach(d=>D(d)&&e.observe(d)),n.removedNodes.forEach(d=>D(d)&&e.unobserve(d))}),u()}),s.observe(t,{childList:!0,attributes:!1}),a=new MutationObserver(()=>u()),a.observe(t,{childList:!1,attributes:!0}),u()}function i(){e.disconnect(),s.disconnect(),a.disconnect()}let c=!1;function u(){c||(c=!0,requestAnimationFrame(()=>{r(),t[x]=t.offsetWidth,t[w]=t.offsetHeight,a.takeRecords(),c=!1}))}return{relayout:u,mount:o,unmount:i}}const dt=(t,r)=>lt(t,()=>{ct(t,{getW:e=>e.offsetWidth,setW:(e,s)=>e.style.width=s+"px",getH:e=>(e[x]=e.offsetWidth,e[w]=e.offsetHeight),setH:(e,s)=>e.style.height=s+"px",getPad:e=>{const s=getComputedStyle(e);return[parseInt(s.paddingTop),parseInt(s.paddingRight),parseInt(s.paddingBottom),parseInt(s.paddingLeft)]},setX:(e,s)=>e.style.left=s+"px",setY:(e,s)=>e.style.top=s+"px",getChildren:e=>e.children},r)});document.head.appendChild(Object.assign(document.createElement("style"),{innerText:at}));const ut=()=>({cols:2,gap:4}),ft={gap:t=>typeof t=="string"?t.includes(" ")?t.split(" ").map(Number):Number(t):t};class pt extends nt(ut,ft){constructor(){super()}connectedCallback(){this._layout=dt(this,this),this._layout.mount()}disconnectedCallback(){this._layout.unmount()}render(){var r;(r=this._layout)==null||r.relayout()}}customElements.get("wc-waterfall")||customElements.define("wc-waterfall",pt);const gt={class:"flex min-h-screen dark:text-gray-200"},ht={class:"w-1/3 hidden lg:block bg-gray-100 dark:bg-gray-800 p-4 h-screen overflow-y-auto"},mt={class:"flex-1 p-4 h-screen overflow-y-auto dark:bg-gray-900"},bt=["cols"],_t=_({__name:"SelectView",setup(t){const r=R(),e=S(()=>r.artifacts),s=S(()=>r.currentArtifact),a=L(),o=O(3),i=()=>{window.innerWidth>=1280?o.value=4:window.innerWidth>=768?o.value=3:window.innerWidth>=400?o.value=2:o.value=1};T(()=>{i(),window.addEventListener("resize",i)}),F(()=>{window.removeEventListener("resize",i)});const c=n=>{r.setCurrentArtifact(n)},u=n=>{r.setCurrentArtifact(n),window.innerWidth<1024&&a.push(`/detail/${n.id}`)},l=n=>{const d={id:Date.now().toString(),name:"新文物",imageUrl:n,description:"新上传的文物描述"};r.artifacts.push(d)};return(n,d)=>(p(),h("div",gt,[f("div",ht,[j(Q,{artifact:s.value},null,8,["artifact"])]),f("div",mt,[f("wc-waterfall",{gap:4,cols:o.value},[(p(!0),h(V,null,P(e.value,m=>(p(),q(et,{key:m.id,artifact:m,onDragstart:c,onClick:u},null,8,["artifact"]))),128)),j(ot,{onUpload:l})],8,bt)])]))}});export{_t as default};
